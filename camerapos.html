<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>A-Frame VR Keyboard Control</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Camera Rig -->
      <a-entity id="cameraRig" position="0 0 0" cursor-teleport="cameraRig: #cameraRig; cameraHead: #head; collisionEntities: .collision; ignoreEntities: .clickable">
        <a-entity id="head" position="0 1.52 0" camera look-controls="reverseMouseDrag: true"></a-entity>
        <a-entity id="ctlL" laser-controls="hand: left" raycaster="objects: .clickable" line="color: red; opacity: 0.75" blink-controls="collisionEntities: .collision; cameraRig: #cameraRig; teleportOrigin: #head; curveShootingSpeed: 6"></a-entity>
        <a-entity id="ctlR" laser-controls="hand: right" raycaster="objects: .clickable" line="color: red; opacity: 0.75" blink-controls="collisionEntities: .collision; cameraRig: #cameraRig; teleportOrigin: #head; curveShootingSpeed: 6"></a-entity>
      </a-entity>

      <!-- Text Entity for Displaying Position -->
      <a-entity id="positionText" position="0 2 -3" text="value: Loading...; color: white;"></a-entity>

      <!-- Add script to update text position -->
      <script>
        AFRAME.registerComponent('update-position-text', {
          tick: function () {
            var cameraRig = document.querySelector('#cameraRig');
            var positionText = document.querySelector('#positionText');

            // Get the position of the cameraRig
            var position = cameraRig.getAttribute('position');
            var positionTextValue = `Position: ${position.x.toFixed(2)}, ${position.y.toFixed(2)}, ${position.z.toFixed(2)}`;

            // Update the text entity's value
            positionText.setAttribute('text', 'value', positionTextValue);
          }
        });

        AFRAME.registerComponent('keyboard-controls', {
          schema: {
            speed: {type: 'number', default: 0.1}
          },
          init: function () {
            this.keys = {};
            window.addEventListener('keydown', (event) => {
              this.keys[event.key] = true;
            });
            window.addEventListener('keyup', (event) => {
              this.keys[event.key] = false;
            });
          },
          tick: function (time, timeDelta) {
            var cameraRig = this.el;
            var position = cameraRig.getAttribute('position');
            var speed = this.data.speed;

            if (this.keys['ArrowUp']) {
              position.z -= speed;
            }
            if (this.keys['ArrowDown']) {
              position.z += speed;
            }
            if (this.keys['ArrowLeft']) {
              position.x -= speed;
            }
            if (this.keys['ArrowRight']) {
              position.x += speed;
            }

            cameraRig.setAttribute('position', position);
          }
        });

        // Attach the components to the scene and cameraRig
        document.querySelector('a-scene').setAttribute('update-position-text', '');
        document.querySelector('#cameraRig').setAttribute('keyboard-controls', '');
      </script>
    </a-scene>
  </body>
</html>
