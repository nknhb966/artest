<html>
<head>
<title>AR表示</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  model-viewer {
    width: 90vw;
    height: 90vh;
  }
</style>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

<model-viewer
  id="mainModel"
  ar
  ar-modes="scene-viewer webxr quick-look"
  src="https://www.city.echizen.lg.jp/office/030/021/open-data-echizen_d/fil/00101_kokufuhakkutsu.glb"
  alt="Your Model"
  camera-controls
  autoplay
  magic-leap unstable-webxr
>
</model-viewer>

<model-viewer
  id="arrow"
  src="https://code4fukui.github.io/vr-dinosaur-museum/arrow.glb"
  scale="0.01 0.01 0.01"
  position="1 1 1"
  rotation="0 0 0"
>
</model-viewer>
  
<script>
  // mainModelとarrowのインスタンスを取得
  const mainModel = document.getElementById('mainModel');
  const arrow = document.getElementById('arrow');

  // メインモデルのロードが完了したときのイベントリスナーを設定
  mainModel.addEventListener('loaded', () => {
    // メインモデルのロード完了後に、矢印の位置と回転を更新
    arrow.setAttribute('animation-mixer', { loop: 'repeat' }); // アニメーションを繰り返し再生
    arrow.setAttribute('animation-mixer', { clip: '*'}); // 全てのアニメーションを再生
    arrow.object3D.position.copy(mainModel.object3D.position); // メインモデルと同じ位置に矢印を配置
    arrow.object3D.rotation.copy(mainModel.object3D.rotation); // メインモデルと同じ回転を矢印に設定

    // メインモデルのアニメーションに合わせて矢印も移動する
    mainModel.addEventListener('animation-played', (event) => {
      arrow.setAttribute('animation-mixer', { time: event.detail.time }); // メインモデルのアニメーションと同じ位置に矢印のアニメーションを設定
    });
  });
</script>
  
</body>
</html>
